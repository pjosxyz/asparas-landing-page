---
import TestimonialCard from "../components/TestimonialCard.astro";
import type { Testimonial } from "../types/types.ts";

const testimonialsData: Testimonial[] = [
  {
    id: 1,
    name: "Clive Woodward",
    location: "Hurstville",
    testimonial:
      "Using Asparas helped me sell my spare place very quickly. Too easy.",
    imgStr: "clive_m_50s",
  },
  {
    id: 2,
    name: "Duncan Williamson",
    location: "Clovelly",
    testimonial:
      "Finding a decent place is usually a pain, but Asparas made it easy.",
    imgStr: "duncan_m_30s",
  },
  {
    id: 3,
    name: "Jonah Murray",
    location: "Tamarama",
    testimonial:
      "I was able to find a place in a great location, really quickly.",
    imgStr: "jonah_m_30s",
  },
  {
    id: 5,
    name: "Larry Latham",
    location: "Bondi",
    testimonial: "Never flipped a place so quickly.",
    imgStr: "larry_m_40s",
  },
  {
    id: 6,
    name: "Melanie Gardner",
    location: "Coogee",
    testimonial: "Renting a place out was a breeze with Asparas.",
    imgStr: "melanie_f_30s",
  },
  {
    id: 7,
    name: "Milandra Singh",
    location: "Newtown",
    testimonial: "My go to for finding a place to rent.",
    imgStr: "milandra_f_30s",
  },
  {
    id: 8,
    name: "Nigel Tufnell",
    location: "Manly",
    testimonial:
      "I usually use a real estate agent, but Asparas was so much easier.",
    imgStr: "nigel_m_40s",
  },
  {
    id: 9,
    name: "Sandra Sweeney",
    location: "Bondi",
    testimonial: "How easy was that? Found a place in no time.",
    imgStr: "sandra_f_50s",
  },
  {
    id: 10,
    name: "Sunny Fong",
    location: "Rose Bay",
    testimonial: "Never thought I'd be able to find a place so quickly.",
    imgStr: "sunny_f_40s",
  },
  {
    id: 11,
    name: "Tina Duckworth",
    location: "Bronte",
    testimonial: "I wish I could sell my place every day.",
    imgStr: "tina_f_50s",
  },
  {
    id: 12,
    name: "Tony Blake",
    location: "Randwick",
    testimonial: "Too fucking easy, mate.",
    imgStr: "tony_m_50s",
  },
];
---

<div class="flex gap-3 overflow-hidden w-full cards">
  {
    testimonialsData.map((testimonial) => (
      <TestimonialCard
        id={testimonial.id}
        name={testimonial.name}
        testimonial={testimonial.testimonial}
        location={testimonial.location}
        imgStr={testimonial.imgStr}
      />
    ))
  }
</div>

<!-- CHAT GPT WASTE OF TIME -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>
<script>
  // GSAP 3 syntax
  gsap.registerPlugin(ScrollTrigger);

  const cards = document.querySelector(".cards");
  const cardWidth = document.querySelector(".card").offsetWidth;
  const totalCardsWidth = cardWidth * 12; // Adjust number of cards accordingly

  // Calculate how much we need to move the cards container to appear as an infinite scroll
  const moveX = totalCardsWidth - window.innerWidth;

  // Create the animation
  const scrollAnimation = gsap.to(cards, {
    x: -moveX,
    ease: "none",
    repeat: -1, // Infinite loop
    duration: 10, // Duration of one loop; adjust for speed
    paused: true, // Start paused so we can control play/pause on hover
  });

  // Function to calculate dynamic duration based on remaining distance
  const calculateDuration = () => {
    const currentX = gsap.getProperty(cards, "x");
    return ((moveX + currentX) / moveX) * 10; // Adjust '10' based on your initial duration
  };

  // Play animation on load
  scrollAnimation.play();

  // Slow down and stop on hover
  cards.addEventListener("mouseenter", () => {
    gsap.to(scrollAnimation, {
      duration: calculateDuration(),
      ease: "power1.out",
      progress: 1,
    });
  });

  // Resume scrolling on mouse leave
  cards.addEventListener("mouseleave", () => {
    scrollAnimation.play(0); // Reset and play from start
  });
</script>

